{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{useSelector,useDispatch}from'react-redux';import{selectMessages}from'../chat/chatSlice';import styles from'./MessageList.module.css';import{sendFileMessage}from'../chat/chatThunk';import MessageItem from\"./messageItem\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function MessageList(){const dispatch=useDispatch();const messages=useSelector(selectMessages);const containerRef=useRef(null);const[isDragging,setIsDragging]=useState(false);const dragCounter=useRef(0);useEffect(()=>{if(containerRef.current){containerRef.current.scrollTo({top:containerRef.current.scrollHeight,behavior:'smooth'});}},[messages]);const handleDragEnter=e=>{e.preventDefault();dragCounter.current+=1;setIsDragging(true);};const handleDragLeave=e=>{e.preventDefault();dragCounter.current-=1;if(dragCounter.current===0){setIsDragging(false);}};const handleDragOver=e=>{e.preventDefault();};const handleDrop=e=>{e.preventDefault();dragCounter.current=0;setIsDragging(false);const files=e.dataTransfer.files;if(files&&files.length>0){Array.from(files).forEach(file=>{dispatch(sendFileMessage(file,'mac1'));});}else{console.warn('No files found in drop event.');}};return/*#__PURE__*/_jsxs(\"div\",{ref:containerRef,className:styles.messageListWrapper,onDragEnter:handleDragEnter,onDragLeave:handleDragLeave,onDragOver:handleDragOver,onDrop:handleDrop,children:[isDragging&&/*#__PURE__*/_jsx(\"div\",{className:styles.dropBackdrop,children:\"Drop file to upload\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.messageList,children:messages.map((msg,i)=>/*#__PURE__*/_jsx(MessageItem,{message:msg},i))})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","useSelector","useDispatch","selectMessages","styles","sendFileMessage","MessageItem","jsx","_jsx","jsxs","_jsxs","MessageList","dispatch","messages","containerRef","isDragging","setIsDragging","dragCounter","current","scrollTo","top","scrollHeight","behavior","handleDragEnter","e","preventDefault","handleDragLeave","handleDragOver","handleDrop","files","dataTransfer","length","Array","from","forEach","file","console","warn","ref","className","messageListWrapper","onDragEnter","onDragLeave","onDragOver","onDrop","children","dropBackdrop","messageList","map","msg","i","message"],"sources":["/Users/229240/Downloads/iLanMessage/src/components/messageList.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { selectMessages } from '../chat/chatSlice';\nimport styles from './MessageList.module.css';\nimport { AppDispatch } from '../store';\nimport { sendFileMessage } from '../chat/chatThunk';\nimport MessageItem from \"./messageItem\";\n\nexport default function MessageList() {\n    const dispatch = useDispatch<AppDispatch>();\n    const messages = useSelector(selectMessages);\n    const containerRef = useRef<HTMLDivElement | null>(null);\n    const [isDragging, setIsDragging] = useState(false);\n    const dragCounter = useRef(0);\n\n    useEffect(() => {\n        if (containerRef.current) {\n            containerRef.current.scrollTo({\n                top: containerRef.current.scrollHeight,\n                behavior: 'smooth',\n            });\n        }\n    }, [messages]);\n\n    const handleDragEnter = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n        dragCounter.current += 1;\n        setIsDragging(true);\n    };\n\n    const handleDragLeave = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n        dragCounter.current -= 1;\n        if (dragCounter.current === 0) {\n            setIsDragging(false);\n        }\n    };\n\n    const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n    };\n\n    const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n        dragCounter.current = 0;\n        setIsDragging(false);\n\n        const files = e.dataTransfer.files;\n        if (files && files.length > 0) {\n            Array.from(files).forEach((file) => {\n                dispatch(sendFileMessage(file, 'mac1'));\n            });\n        } else {\n            console.warn('No files found in drop event.');\n        }\n    };\n\n\n    return (\n        <div\n            ref={containerRef}\n            className={styles.messageListWrapper}\n            onDragEnter={handleDragEnter}\n            onDragLeave={handleDragLeave}\n            onDragOver={handleDragOver}\n            onDrop={handleDrop}\n        >\n            {isDragging && (\n                <div className={styles.dropBackdrop}>\n                    Drop file to upload\n                </div>\n            )}\n            <div className={styles.messageList}>\n                {messages.map((msg, i) => (\n                    <MessageItem key={i} message={msg} />\n                ))}\n            </div>\n        </div>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}