{"ast":null,"code":"var _jsxFileName = \"/Users/229240/Downloads/iLanMessage/src/components/messageList.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { selectMessages } from '../chat/chatSlice';\nimport styles from './MessageList.module.css';\nimport { sendFileMessage } from '../chat/chatThunk';\nimport MessageItem from \"./messageItem\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MessageList() {\n  _s();\n  const dispatch = useDispatch();\n  const messages = useSelector(selectMessages);\n  const containerRef = useRef(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const dragCounter = useRef(0);\n  useEffect(() => {\n    if (containerRef.current) {\n      containerRef.current.scrollTo({\n        top: containerRef.current.scrollHeight,\n        behavior: 'smooth'\n      });\n    }\n  }, [messages]);\n  const handleDragEnter = e => {\n    e.preventDefault();\n    dragCounter.current += 1;\n    setIsDragging(true);\n  };\n  const handleDragLeave = e => {\n    e.preventDefault();\n    dragCounter.current -= 1;\n    if (dragCounter.current === 0) {\n      setIsDragging(false);\n    }\n  };\n  const handleDragOver = e => {\n    e.preventDefault();\n  };\n  const handleDrop = e => {\n    e.preventDefault();\n    dragCounter.current = 0;\n    setIsDragging(false);\n    const files = e.dataTransfer.files;\n    if (files && files.length > 0) {\n      Array.from(files).forEach(file => {\n        dispatch(sendFileMessage(file, 'mac1'));\n      });\n    } else {\n      console.warn('No files found in drop event.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    className: styles.messageListWrapper,\n    onDragEnter: handleDragEnter,\n    onDragLeave: handleDragLeave,\n    onDragOver: handleDragOver,\n    onDrop: handleDrop,\n    children: [isDragging && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.dropBackdrop,\n      children: \"Drop file to upload\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.messageList,\n      children: messages.map((msg, i) => /*#__PURE__*/_jsxDEV(MessageItem, {\n        message: msg\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 9\n  }, this);\n}\n_s(MessageList, \"70EMXQDsj1aXSQaTN2vKlDezi+s=\", false, function () {\n  return [useDispatch, useSelector];\n});\n_c = MessageList;\nvar _c;\n$RefreshReg$(_c, \"MessageList\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useSelector","useDispatch","selectMessages","styles","sendFileMessage","MessageItem","jsxDEV","_jsxDEV","MessageList","_s","dispatch","messages","containerRef","isDragging","setIsDragging","dragCounter","current","scrollTo","top","scrollHeight","behavior","handleDragEnter","e","preventDefault","handleDragLeave","handleDragOver","handleDrop","files","dataTransfer","length","Array","from","forEach","file","console","warn","ref","className","messageListWrapper","onDragEnter","onDragLeave","onDragOver","onDrop","children","dropBackdrop","fileName","_jsxFileName","lineNumber","columnNumber","messageList","map","msg","i","message","_c","$RefreshReg$"],"sources":["/Users/229240/Downloads/iLanMessage/src/components/messageList.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { selectMessages } from '../chat/chatSlice';\nimport styles from './MessageList.module.css';\nimport { AppDispatch } from '../store';\nimport { sendFileMessage } from '../chat/chatThunk';\nimport MessageItem from \"./messageItem\";\n\nexport default function MessageList() {\n    const dispatch = useDispatch<AppDispatch>();\n    const messages = useSelector(selectMessages);\n    const containerRef = useRef<HTMLDivElement | null>(null);\n    const [isDragging, setIsDragging] = useState(false);\n    const dragCounter = useRef(0);\n\n    useEffect(() => {\n        if (containerRef.current) {\n            containerRef.current.scrollTo({\n                top: containerRef.current.scrollHeight,\n                behavior: 'smooth',\n            });\n        }\n    }, [messages]);\n\n    const handleDragEnter = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n        dragCounter.current += 1;\n        setIsDragging(true);\n    };\n\n    const handleDragLeave = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n        dragCounter.current -= 1;\n        if (dragCounter.current === 0) {\n            setIsDragging(false);\n        }\n    };\n\n    const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n    };\n\n    const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\n        e.preventDefault();\n        dragCounter.current = 0;\n        setIsDragging(false);\n\n        const files = e.dataTransfer.files;\n        if (files && files.length > 0) {\n            Array.from(files).forEach((file) => {\n                dispatch(sendFileMessage(file, 'mac1'));\n            });\n        } else {\n            console.warn('No files found in drop event.');\n        }\n    };\n\n\n    return (\n        <div\n            ref={containerRef}\n            className={styles.messageListWrapper}\n            onDragEnter={handleDragEnter}\n            onDragLeave={handleDragLeave}\n            onDragOver={handleDragOver}\n            onDrop={handleDrop}\n        >\n            {isDragging && (\n                <div className={styles.dropBackdrop}>\n                    Drop file to upload\n                </div>\n            )}\n            <div className={styles.messageList}>\n                {messages.map((msg, i) => (\n                    <MessageItem key={i} message={msg} />\n                ))}\n            </div>\n        </div>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}